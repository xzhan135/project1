#include <iostream>
#include <fstream>
#include <string>

#include "TString.h"
#include "TFile.h"
#include "TH1.h"
#include "TF1.h"
#include "TCanvas.h"
#include "TGraph.h"
#include "TColor.h"
#include "TLegend.h"
#include "TStyle.h"

int main(){

	TFile* f01 = new TFile("/home/xzhan135/data/P50Data/MC/Na22-P50D-MC/Na22-pw-2-0_Det_E.root");
  f01->ls();

	TH1F* hnew01 = new TH1F("hnew02", "MC Energy Deposition", 250, 0., 5.);
	hnew01 = (TH1F*)f01->Get("E_dep_0");

	TFile* f02 = new TFile("/home/xzhan135/data/P50Data/MC/Na22-P50D-MC/Na22-pw-2-0_DetSim-Processed.root");
	TH1F* hnew02 = new TH1F("hnew03", "MC Energy Reconstructed", 250, 0., 5.);
	hnew02 = (TH1F*)f02->Get("hEGamma0");

	TFile* f03 = new TFile("/home/xzhan135/data/P50Data/Data/Na22-P50D-Data-S028-F015-Processed.root");
	TH1F* hnew03 = new TH1F("hnew03", "Data Energy Reconstructed", 250, 0., 5.);
	hnew03 = (TH1F*)f03->Get("hEGamma0");

  Double_t norm = 1;
  hnew01->Scale(norm/hnew01->Integral(), "width");
  hnew02->Scale(norm/hnew02->Integral(), "width");
  hnew03->Scale(norm/hnew03->Integral(), "width");

	TCanvas *c1 = new TCanvas("c1","Compare Detector Response",20,10,700,400);
  gStyle->SetOptStat(0);
  c1->cd();

  hnew01->SetTitle("P50D Na22 at Middle, seg - 0");
	hnew01->GetXaxis()->SetRangeUser(0, 10.);
  hnew01->SetLineColor(kRed);
  hnew01->SetLineWidth(1);
  hnew01->SetLineStyle(2);
  hnew01->Draw("");
  hnew02->SetLineWidth(2);
  hnew02->SetLineColor(kBlue);
  hnew02->Draw("SAME");
	hnew03->SetLineWidth(2);
  hnew03->SetLineColor(kGreen);
  hnew03->Draw("SAME");
  TLegend* l1 = new TLegend(0.75, 0.75, 0.95, 0.95);
  l1->SetFillColor(kWhite);
  l1->SetTextFont(132);
  l1->AddEntry(hnew01, "MC E Deposition", "l");
  l1->AddEntry(hnew02, "MC E Reconstructed", "l");
  l1->AddEntry(hnew03, "Data E Reconstructedd", "l");
  l1->Draw();

  c1->SaveAs("CompareDetResponseNa22-2-0.pdf");
	c1->SaveAs("CompareDetResponseNa22-2-0.png");

  TFile* gOutputFile = new TFile("CompareDetResponseNa22-2-0.root", "RECREATE");
  gOutputFile->cd();
  hnew01->Write();
  hnew02->Write();
  hnew03->Write();
  gOutputFile->Close();

  return 0;
}
